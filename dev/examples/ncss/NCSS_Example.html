<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Basic NCSS &mdash; Siphon 0.9</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/theme_override.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-rendered-html.css" type="text/css" />
    <link rel="canonical" href="https://unidata.github.io/siphon/latest/examples/ncss/NCSS_Example.html"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="NCSS and CartoPy" href="NCSS_Cartopy_Example.html" />
    <link rel="prev" title="NCSS Time Series" href="NCSS_Timeseries_Examples.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Siphon
            <img src="../../_static/siphon_150x150.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.9
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installguide.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">The Siphon API</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Siphon Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#general-examples">General Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#acis-web-services">ACIS Web Services</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#ncss">NCSS</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="NCSS_Timeseries_Examples.html">NCSS Time Series</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Basic NCSS</a></li>
<li class="toctree-l3"><a class="reference internal" href="NCSS_Cartopy_Example.html">NCSS and CartoPy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#national-data-buoy-center-ndbc">National Data Buoy Center (NDBC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#upper-air">Upper Air</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../developerguide.html">Developer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CONTRIBUTING.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../citing.html">Citing Siphon</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Siphon</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          
<div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Siphon Examples</a> &raquo;</li>
      <li>Basic NCSS</li>
    <li class="source-link">
        
            
                
                
                <a href="https://github.com/Unidata/siphon/issues/new?title=Suggested%20improvement%20for%20examples/ncss/NCSS_Example&body=Please%20describe%20what%20could%20be%20improved%20about%20this%20page%20or%20the%20typo/mistake%20that%20you%20found%3A"
                   class="fa fa-github"> Improve this page</a>
            
        
    </li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-examples-ncss-ncss-example-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="basic-ncss">
<span id="sphx-glr-examples-ncss-ncss-example-py"></span><h1>Basic NCSS<a class="headerlink" href="#basic-ncss" title="Permalink to this headline">¶</a></h1>
<p>Use Siphon to query the NetCDF Subset Service (NCSS).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">siphon.catalog</span> <span class="kn">import</span> <a href="../../api/catalog.html#siphon.catalog.TDSCatalog" title="siphon.catalog.TDSCatalog" class="sphx-glr-backref-module-siphon-catalog sphx-glr-backref-type-py-class"><span class="n">TDSCatalog</span></a>
</pre></div>
</div>
<p>First we construct a TDSCatalog instance pointing to our dataset of interest, in
this case TDS’ “Best” virtual dataset for the GFS global 0.5 degree collection of
GRIB files. We see this catalog contains a single dataset.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../api/catalog.html#siphon.catalog.TDSCatalog" title="siphon.catalog.TDSCatalog" class="sphx-glr-backref-module-siphon-catalog sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">best_gfs</span></a> <span class="o">=</span> <a href="../../api/catalog.html#siphon.catalog.TDSCatalog" title="siphon.catalog.TDSCatalog" class="sphx-glr-backref-module-siphon-catalog sphx-glr-backref-type-py-class"><span class="n">TDSCatalog</span></a><span class="p">(</span><span class="s1">&#39;http://thredds.ucar.edu/thredds/catalog/grib/NCEP/GFS/&#39;</span>
                      <span class="s1">&#39;Global_0p5deg/catalog.xml?dataset=grib/NCEP/GFS/Global_0p5deg/Best&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="../../api/catalog.html#siphon.catalog.DatasetCollection" title="siphon.catalog.DatasetCollection" class="sphx-glr-backref-module-siphon-catalog sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">best_gfs</span><span class="o">.</span><span class="n">datasets</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[&#39;Best GFS Half Degree Forecast Time Series&#39;]
</pre></div>
</div>
<p>We pull out this dataset and get the NCSS access point</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../api/catalog.html#siphon.catalog.Dataset" title="siphon.catalog.Dataset" class="sphx-glr-backref-module-siphon-catalog sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">best_ds</span></a> <span class="o">=</span> <a href="../../api/catalog.html#siphon.catalog.DatasetCollection" title="siphon.catalog.DatasetCollection" class="sphx-glr-backref-module-siphon-catalog sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">best_gfs</span><span class="o">.</span><span class="n">datasets</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a href="../../api/ncss.html#siphon.ncss.NCSS" title="siphon.ncss.NCSS" class="sphx-glr-backref-module-siphon-ncss sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ncss</span></a> <span class="o">=</span> <a href="../../api/catalog.html#siphon.catalog.Dataset.subset" title="siphon.catalog.Dataset.subset" class="sphx-glr-backref-module-siphon-catalog sphx-glr-backref-type-py-method"><span class="n">best_ds</span><span class="o">.</span><span class="n">subset</span></a><span class="p">()</span>
</pre></div>
</div>
<p>We can then use the <em class="xref py py-obj">ncss</em> object to create a new query object, which
facilitates asking for data from the server.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../api/ncss.html#siphon.ncss.NCSSQuery" title="siphon.ncss.NCSSQuery" class="sphx-glr-backref-module-siphon-ncss sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">query</span></a> <span class="o">=</span> <a href="../../api/ncss.html#siphon.ncss.NCSS.query" title="siphon.ncss.NCSS.query" class="sphx-glr-backref-module-siphon-ncss sphx-glr-backref-type-py-method"><span class="n">ncss</span><span class="o">.</span><span class="n">query</span></a><span class="p">()</span>
</pre></div>
</div>
<p>We construct a query asking for data corresponding to latitude 40N and longitude 105W,
for the current time. We also ask for NetCDF version 4 data, for the variables
‘Temperature_isobaric’ and ‘Relative_humidity_isobaric’. This request will return all
vertical levels for a single point and single time. Note the string representation of
the query is a properly encoded query string.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../api/ncss.html#siphon.ncss.NCSSQuery.lonlat_point" title="siphon.ncss.NCSSQuery.lonlat_point" class="sphx-glr-backref-module-siphon-ncss sphx-glr-backref-type-py-method"><span class="n">query</span><span class="o">.</span><span class="n">lonlat_point</span></a><span class="p">(</span><span class="o">-</span><span class="mi">105</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span><span class="o">.</span><span class="n">time</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">())</span>
<a href="../../api/ncss.html#siphon.ncss.NCSSQuery.accept" title="siphon.ncss.NCSSQuery.accept" class="sphx-glr-backref-module-siphon-ncss sphx-glr-backref-type-py-method"><span class="n">query</span><span class="o">.</span><span class="n">accept</span></a><span class="p">(</span><span class="s1">&#39;netcdf4&#39;</span><span class="p">)</span>
<a href="../../api/ncss.html#siphon.ncss.NCSSQuery.variables" title="siphon.ncss.NCSSQuery.variables" class="sphx-glr-backref-module-siphon-ncss sphx-glr-backref-type-py-method"><span class="n">query</span><span class="o">.</span><span class="n">variables</span></a><span class="p">(</span><span class="s1">&#39;Temperature_isobaric&#39;</span><span class="p">,</span> <span class="s1">&#39;Relative_humidity_isobaric&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>var=Temperature_isobaric&amp;var=Relative_humidity_isobaric&amp;time=2022-01-11T18%3A22%3A40.848475&amp;longitude=-105&amp;latitude=40&amp;accept=netcdf4
</pre></div>
</div>
<p>We now request data from the server using this query. The <em class="xref py py-obj">NCSS</em> class handles parsing
this NetCDF data (using the <code class="xref py py-obj docutils literal notranslate"><span class="pre">netCDF4</span></code> module). If we print out the variable names,
we see our requested variables, as well as a few others (more metadata information)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <a href="../../api/ncss.html#siphon.ncss.NCSS.get_data" title="siphon.ncss.NCSS.get_data" class="sphx-glr-backref-module-siphon-ncss sphx-glr-backref-type-py-method"><span class="n">ncss</span><span class="o">.</span><span class="n">get_data</span></a><span class="p">(</span><a href="../../api/ncss.html#siphon.ncss.NCSSQuery" title="siphon.ncss.NCSSQuery" class="sphx-glr-backref-module-siphon-ncss sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">query</span></a><span class="p">)</span>
<span class="nb">list</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span><span class="o">.</span><span class="n">variables</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[&#39;isobaric1&#39;, &#39;Temperature_isobaric&#39;, &#39;Relative_humidity_isobaric&#39;, &#39;station_name&#39;, &#39;station_description&#39;, &#39;latitude&#39;, &#39;longitude&#39;, &#39;time&#39;]
</pre></div>
</div>
<p>We’ll pull out the variables we want to use, as well as the pressure values. To get the
name of the correct variable for pressure (which matches the levels for temperature and
relative humidity, we look at the <em class="xref py py-obj">coordinates</em> attribute. The last of the variables
listed in <em class="xref py py-obj">coordinates</em> is the pressure dimension.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span><span class="o">.</span><span class="n">variables</span></a><span class="p">[</span><span class="s1">&#39;Temperature_isobaric&#39;</span><span class="p">]</span>
<span class="n">relh</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span><span class="o">.</span><span class="n">variables</span></a><span class="p">[</span><span class="s1">&#39;Relative_humidity_isobaric&#39;</span><span class="p">]</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">press_name</span></a> <span class="o">=</span> <span class="n">relh</span><span class="o">.</span><span class="n">coordinates</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">press</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span><span class="o">.</span><span class="n">variables</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">press_name</span></a><span class="p">]</span>
<a href="https://numpy.org/doc/stable/reference/maskedarray.baseclass.html#numpy.ma.MaskedArray" title="numpy.ma.MaskedArray" class="sphx-glr-backref-module-numpy-ma sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">press_vals</span></a> <span class="o">=</span> <span class="n">press</span><span class="p">[:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>

<span class="c1"># Due to a different number of vertical levels find where they are common</span>
<span class="n">lev_temp</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="nb">next</span><span class="p">(</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">temp</span><span class="o">.</span><span class="n">coordinates</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;isobaric&#39;</span><span class="p">))]</span>
<span class="n">lev_relh</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="nb">next</span><span class="p">(</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">relh</span><span class="o">.</span><span class="n">coordinates</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;isobaric&#39;</span><span class="p">))]</span>
<a href="https://numpy.org/doc/stable/reference/maskedarray.baseclass.html#numpy.ma.MaskedArray" title="numpy.ma.MaskedArray" class="sphx-glr-backref-module-numpy-ma sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">_</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">relh_ind</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">temp_ind</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.intersect1d.html#numpy.intersect1d" title="numpy.intersect1d" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span></a><span class="p">(</span><span class="n">lev_relh</span><span class="p">,</span> <span class="n">lev_temp</span><span class="p">,</span> <span class="n">return_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/maskedarray.baseclass.html#numpy.ma.MaskedArray" title="numpy.ma.MaskedArray" class="sphx-glr-backref-module-numpy-ma sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">temp_filtered</span></a> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">temp_ind</span></a><span class="p">]</span>
<a href="https://numpy.org/doc/stable/reference/maskedarray.baseclass.html#numpy.ma.MaskedArray" title="numpy.ma.MaskedArray" class="sphx-glr-backref-module-numpy-ma sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">relh_filtered</span></a> <span class="o">=</span> <span class="n">relh</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">relh_ind</span></a><span class="p">]</span>
</pre></div>
</div>
<p>Now we can plot these up using matplotlib.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fig</span></a><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.axes.Axes.plot.html#matplotlib.axes.Axes.plot" title="matplotlib.axes.Axes.plot" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/maskedarray.baseclass.html#numpy.ma.MaskedArray" title="numpy.ma.MaskedArray" class="sphx-glr-backref-module-numpy-ma sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">temp_filtered</span></a><span class="p">[:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <a href="https://numpy.org/doc/stable/reference/maskedarray.baseclass.html#numpy.ma.MaskedArray" title="numpy.ma.MaskedArray" class="sphx-glr-backref-module-numpy-ma sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">press_vals</span></a><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.axes.Axes.set_xlabel.html#matplotlib.axes.Axes.set_xlabel" title="matplotlib.axes.Axes.set_xlabel" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span></a><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">temp</span><span class="o">.</span><span class="n">standard_name</span></a><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">temp</span><span class="o">.</span><span class="n">units</span></a><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.axes.Axes.set_ylabel.html#matplotlib.axes.Axes.set_ylabel" title="matplotlib.axes.Axes.set_ylabel" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span></a><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">press</span><span class="o">.</span><span class="n">standard_name</span></a><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">press</span><span class="o">.</span><span class="n">units</span></a><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>

<span class="c1"># Create second plot with shared y-axis</span>
<span class="n">ax2</span> <span class="o">=</span> <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.twiny.html#matplotlib.pyplot.twiny" title="matplotlib.pyplot.twiny" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">twiny</span></a><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.axes.Axes.plot.html#matplotlib.axes.Axes.plot" title="matplotlib.axes.Axes.plot" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/maskedarray.baseclass.html#numpy.ma.MaskedArray" title="numpy.ma.MaskedArray" class="sphx-glr-backref-module-numpy-ma sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">relh_filtered</span></a><span class="p">[:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <a href="https://numpy.org/doc/stable/reference/maskedarray.baseclass.html#numpy.ma.MaskedArray" title="numpy.ma.MaskedArray" class="sphx-glr-backref-module-numpy-ma sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">press_vals</span></a><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.axes.Axes.set_xlabel.html#matplotlib.axes.Axes.set_xlabel" title="matplotlib.axes.Axes.set_xlabel" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span></a><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">relh</span><span class="o">.</span><span class="n">standard_name</span></a><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">relh</span><span class="o">.</span><span class="n">units</span></a><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.axes.Axes.set_ylim.html#matplotlib.axes.Axes.set_ylim" title="matplotlib.axes.Axes.set_ylim" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ma.MaskedArray.max.html#numpy.ma.MaskedArray.max" title="numpy.ma.MaskedArray.max" class="sphx-glr-backref-module-numpy-ma sphx-glr-backref-type-py-method"><span class="n">press_vals</span><span class="o">.</span><span class="n">max</span></a><span class="p">(),</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ma.MaskedArray.min.html#numpy.ma.MaskedArray.min" title="numpy.ma.MaskedArray.min" class="sphx-glr-backref-module-numpy-ma sphx-glr-backref-type-py-method"><span class="n">press_vals</span><span class="o">.</span><span class="n">min</span></a><span class="p">())</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.axes.Axes.grid.html#matplotlib.axes.Axes.grid" title="matplotlib.axes.Axes.grid" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">grid</span></a><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_NCSS_Example_001.png" srcset="../../_images/sphx_glr_NCSS_Example_001.png" alt="NCSS Example" class = "sphx-glr-single-img"/><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  3.720 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-ncss-ncss-example-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/65e221bb351db8556ea17877cbb9a185/NCSS_Example.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">NCSS_Example.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/70750d30e625b0cc715a662247de4777/NCSS_Example.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">NCSS_Example.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="NCSS_Timeseries_Examples.html" class="btn btn-neutral float-left" title="NCSS Time Series" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="NCSS_Cartopy_Example.html" class="btn btn-neutral float-right" title="NCSS and CartoPy" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018, Siphon Contributors.
      <span class="lastupdated">Last updated on Jan 11, 2022 at 18:23:24.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-92978945-1', 'auto');
  ga('send', 'pageview');

</script>
     


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>